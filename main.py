import timeimport osfrom requests.auth import HTTPBasicAuthimport requestsimport shutilfrom motion import *import credurl = cred.urlpath = cred.pathlastImage = FalsethisImage = Falsedef get_tmp_file_name():    return str(int(10 * time.time())) + '_tmp.jpg'# def get_file_name(file_name):#     try:#         mtime = os.path.getmtime(file_name)#     except OSError:#         mtime = 0#     return mtimedef get_image(path, tmp_name):    global thisImage, lastImage    # print "Getting Image..."    if thisImage:        lastImage = thisImage    thisImage = str(path) + '/' + str(tmp_name)    # get one image    r = requests.get(url, stream=True, auth=HTTPBasicAuth(cred.user, cred.pwd))    if r.status_code == 200:        with open(thisImage, 'wb') as f:            r.raw.decode_content = True            shutil.copyfileobj(r.raw, f)starttime = time.time()count = 0while True:    tmp_name = get_tmp_file_name()    get_image(path, tmp_name)    if lastImage:        if compare_images(Image.open(lastImage), Image.open(thisImage)) > 0.6:            print "Detected %s" % tmp_name.replace('_tmp.jpg', '')    count += 1    time.sleep(0.5 - ((time.time() - starttime) % 0.5))